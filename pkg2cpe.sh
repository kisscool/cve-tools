#!/bin/sh
# vim: set softtabstop=2 shiftwidth=2 expandtab :
# (c) 2020 KissCool

# Usage : pkg2cpe.sh pkg.txt

awk '
  $2 !~ /cpe/ {
    split($1,array,"_");
    sub(/[-a-z].*/,"",array[2]);
    printf "%-30s\tcpe:2.3:a:*:%s:%s:*:*:*:*:*:*:*\n", $1, array[1], array[2];
  } 
  
  $2 ~ /cpe/ {
    printf "%-30s\t%s\n", $1, $2;
  }
' $1
