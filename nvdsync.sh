#!/bin/sh
# vim: set softtabstop=2 shiftwidth=2 expandtab :
# (c) 2019 KissCool

# initialize or update the NVD dataset

# robustify the script
topdir=`dirname "$(realpath $0)"`

# synchronize the dataset
nvdsync -v=1 -cpe_feed=cpe-2.3.xml.gz -cve_feed=cve-1.0.json.gz "${topdir}"/nvd/
# create the CVE/description reduction in order to optimize the following searches
zcat "${topdir}"/nvd/*.json.gz | jq '.CVE_Items[] | {(.cve.CVE_data_meta.ID): .cve.description.description_data[0].value}' > "${topdir}"/nvd/cve_redux.json
