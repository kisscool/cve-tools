CVE-TOOLS
=========

Some shell scripts to cross reference public CVE with a list of components described as a list of CPE.
I created those scripts for my own personal needs : they are simple, crude, without any proper options or input sanitization. Use them at your own risks.

Dependencies
------------

Those scripts assume the following is in your $PATH :

* [`NVD Tools`](https://github.com/facebookincubator/nvdtools)
* [`JQ`](https://github.com/stedolan/jq)
* `zcat`
* Standard POSIX utilities like `sh` and `awk` (disclaimer : I use some common-but-not-POSIX awk options)

Those scripts have been tested on FreeBSD and GNU/Linux.

Usage example
-------------

### First use

Create a tab separated text file called cpe.txt with whatever you want in the first column (usually package names) and CPE identifiers in the second column. Then :

	# install pre-requisites
	pkg install jq
	go install github.com/facebookincubator/nvdtools/cmd/...@latest
	# initialize the NVD dataset
	./nvdsync.sh
	# then create a new correlation report between your CPE and CVE in ./reports/ complete with description, CVSS base vector and score
	# please note that all the intermediate steps of the report remain in the directory for debugging and analysis
	./cve_master.sh ./inventory/cpe.txt

### Adding CVSS environmental vectors

You can add your own CVSS environmental vectors in the last report, then recalculate the CVSS score with the following command :

	./cve_calculate.sh ./reports/cve_somedate_step4.tsv > ./reports/cve_somedate_step5.tsv

### Refreshing and old report

Let's say you have an old report you edited by hand (environmental vector only) called cve_oldate_step5.txt and you want to make an update :

	# synchronize the NVD dataset
	./nvdsync.sh
	# create a new correlation
	./cve_master.sh ./inventory/cpe.txt
	# comparison with the old report
	./cve_compare.sh ./reports/cve_oldate_step5.tsv ./reports/cve_newdate_step4.tsv > ./reports/cve_newdate_step5.tsv
	# then complete the report by hand with the missing CVSS environmental vectors, then re-run the caculations
	./cve_calculate.sh ./reports/cve_newdate_step5.tsv > ./reports/cve_newdate_step6.tsv


