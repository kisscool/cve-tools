CVE-TOOLS
=========

Some shell scripts to cross reference public CVE with a list of components described as a list of CPE.
I created those scripts for my own personal needs : they are simple, crude, without any proper options or input sanitization. Use them at your own risks.

Dependencies
------------

Those scripts assume the following is in your $PATH :

* [`NVD Tools`](https://github.com/facebookincubator/nvdtools)
* [`JQ`](https://github.com/stedolan/jq)
* `zcat`
* Standard POSIX utilities like `sh` and `awk` (disclaimer : I use some common-but-not-POSIX awk options)

Those scripts have been tested on FreeBSD and GNU/Linux.

Usage example
-------------

### First use

Create a CSV-like text file called cpe.txt with whatever you want in the first column and CPE identifiers in the second column. Then :

	# install pre-requisites
	pkg install jq
	go get github.com/facebookincubator/nvdtools/...
	# initialize the NVD dataset
	./nvdsync.sh
	# create a correlation report between your CPE and CVE in ./report/cve_raw_$date.txt
	date=`date +'%y%m%d'`
	./cpe2cve.sh ./inventory/cpe.txt > ./reports/cve_raw_$date.txt
	# then complete the report with cve descriptions
	./cve2description.sh ./reports/cve_raw_$date.txt > ./reports/cve_final_$date.txt

### Next use

Let's say you have an old report you annotated by hand (5th column only) called cve_final_oldate.txt and you want to make an update :

	# synchronize the NVD dataset
	./nvdsync.sh
	# create a new correlation
	date=`date +'%y%m%d'`
	./cpe2cve.sh ./inventory/cpe.txt > ./reports/cve_raw_$date.txt
	# comparison with the old report
	./cve_compare.sh ./reports/cve_final_oldate.txt ./reports/cve_raw_$date.txt > ./reports/cve_intermediate_$date.txt
	# then complete the report with the missing cve descriptions
	./cve2description.sh ./reports/cve_intermediate_$date.txt > ./reports/cve_final_$date.txt


