#!/bin/sh
# vim: set softtabstop=2 shiftwidth=2 expandtab :
# (c) 2019 KissCool

# Usage : cpe2cve.sh cpe.txt

# robustify the script
topdir=`dirname "$(realpath $0)"`

# intialize the new report
format="%-30s\t%-75s\t%-20s\t%s\t%s\t%s\n"
printf $format Package CPE CVE CVSS Assessment Description

# then correlate
cat $1 | cpe2cve -nproc=128 -cpe=2 -cve=3 -cvss=4 "${topdir}"/nvd/*.json.gz
