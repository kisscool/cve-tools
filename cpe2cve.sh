#!/bin/sh
# vim: set softtabstop=2 shiftwidth=2 expandtab :
# (c) 2019 KissCool

# Usage : cpe2cve.sh cpe.txt

# robustify the script
topdir=`dirname "$(realpath $0)"`

# intialize the new report
printf "Package\tCPE\tCVE\tBase_score\tBase_vector\tEnv_vector\tFinal_score\tDescription\n"

# then correlate
cat $1 | cpe2cve -nproc=128 -cpe=2 -cve=3 -cvss3=4 "${topdir}"/nvd/nvdcve-1.1-*.json.gz
